<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Controle de Alertas ⚡</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #f4f6f9;
        }

        .btn-alerta {
            width: 140px;
            height: 65px;
            font-weight: bold;
        }

        .relogio {
            font-weight: bold;
        }

        .card {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: none;
        }
    </style>
</head>

<body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <div class="d-flex align-items-center">
                <img src="assets/logo.png" alt="Logo" height="35" class="me-2">
                <a class="navbar-brand mb-0" href="#">
                    <span>Controle de Alertas ⚡</span>
                </a>
            </div>
            <div class="text-white relogio" id="relogio"></div>
        </div>
    </nav>

    <div style="margin-top:90px;"></div>

    <div class="container">

        <div id="painelStatus" class="card text-center mb-4 shadow">
            <div class="card-body">
                <h3 id="statusTexto">Verificando status...</h3>
                <h5 id="cronometro" class="mt-2"></h5>
            </div>
        </div>

        <!-- REGISTRO -->
        <div class="card p-4 mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="mb-0">Registrar Alerta</h5>
            </div>

            <div class="row g-3 align-items-end">

                <!-- DATA -->
                <div class="col-lg-3 col-md-4">
                    <label class="form-label fw-semibold">Data</label>
                    <input type="date" id="dataAlerta" class="form-control">
                </div>

                <!-- HORA -->
                <div class="col-lg-3 col-md-4">
                    <label class="form-label fw-semibold">Hora</label>
                    <input type="time" id="horaAlerta" class="form-control">
                </div>

                <!-- BOTÕES -->
                <div class="col-lg-6 col-md-12">
                    <div class="d-flex justify-content-lg-end justify-content-center gap-3 flex-wrap">

                        <button class="btn btn-success btn-alerta px-4" id="btnVerde">
                            VERDE
                        </button>

                        <button class="btn btn-warning btn-alerta px-4" id="btnAmarelo">
                            AMARELO
                        </button>

                        <button class="btn btn-danger btn-alerta px-4" id="btnVermelho">
                            VERMELHO
                        </button>

                    </div>
                </div>

            </div>
        </div>

        <!-- TABELA -->
        <div class="card p-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="mb-0">Histórico de Alertas</h5>

                <button class="btn btn-success btn-sm" id="btnExportar">
                    Exportar Excel
                </button>
            </div>

            <div class="table-responsive">
                <table class="table table-striped table-bordered text-center">
                    <thead class="table-dark">
                        <tr>
                            <th>Data</th>
                            <th>Tipo</th>
                            <th>Hora Início</th>
                            <th>Hora Fim</th>
                            <th>Vigência (min)</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaAlertas"></tbody>
                </table>
            </div>

            <!-- PAGINAÇÃO -->
            <div class="d-flex justify-content-between align-items-center mt-3">
                <button class="btn btn-outline-secondary" id="btnAnterior">← Anterior</button>
                <span id="infoPagina"></span>
                <button class="btn btn-outline-secondary" id="btnProximo">Próximo →</button>
            </div>
        </div>

        <!-- DASHBOARD -->
        <div class="card p-4 mt-4">
            <h5>Indicadores</h5>

            <!-- FILTRO -->
            <div class="row mb-4">

                <div class="col-md-4">
                    <label>Data Inicial</label>
                    <input type="date" id="filtroInicio" class="form-control">
                </div>

                <div class="col-md-4">
                    <label>Data Final</label>
                    <input type="date" id="filtroFim" class="form-control">
                </div>

                <div class="col-md-4 d-flex align-items-end">
                    <button class="btn btn-primary w-100" id="btnFiltrar">
                        Filtrar
                    </button>
                </div>

            </div>

            <!-- CARDS -->
            <div class="row text-center">

                <div class="col-md-3 mb-3">
                    <div class="p-3 bg-light rounded">
                        <h6>Total Horas Perdidas</h6>
                        <h4 id="cardTotalHoras">0h</h4>
                    </div>
                </div>

                <div class="col-md-3 mb-3">
                    <div class="p-3 bg-light rounded">
                        <h6>Qtd Alertas</h6>
                        <h4 id="cardQtdAlertas">0</h4>
                    </div>
                </div>

                <div class="col-md-3 mb-3">
                    <div class="p-3 bg-light rounded">
                        <h6>Hora Mais Incidente</h6>
                        <h4 id="cardHoraCritica">--:--</h4>
                    </div>
                </div>

                <div class="col-md-3 mb-3">
                    <div class="p-3 bg-light rounded">
                        <h6>Maior Alerta (min)</h6>
                        <h4 id="cardMaiorAlerta">0</h4>
                    </div>
                </div>

            </div>

            <div class="mt-4">
                <canvas id="graficoMensal"></canvas>
            </div>

        </div>

        <!-- scripts -->
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script src="js/app.js"></script>
        <script src="js/supabaseClient.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
        <script src="js/relogio.js"></script>
        <script src="js/features.js"></script>
        <script src="js/dashboard.js"></script>
        <script src="js/exporta.js"></script>

</body>

</html>